---
title: "Data Science--NECC Proposal"
output: pdf_document
bibliography: Bibliography.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, dev = "cairo_pdf")


library(ggplot2)
library(tidyverse)
library(magrittr)
library(readr)
library(sf)
library(ggspatial)
library(gridExtra)


theme_set(theme_bw(base_size=22))
seasonPal2<-c("deepskyblue4","yellowgreen","goldenrod1","orange3") #BEST


```


## Introduction
|   The Northwest Atlantic is a highly productive ecosystem with diverse environments. It holds very high economic value as well with commercial fisheries cumulatively worth \$1.3 billion [@noaa_fisheries_2021_2021; @noaa_fisheries_2021_2021-1]. However, while the region is a focal point for marine commerce, it is also a central location in the progressive climate change occurring around the world. The Gulf of Maine, the northern end of the Northwest Atlantic, is warming faster than 99.9% of the world's oceans [@pershing_evaluating_2015]. The water body is fed primarily by cool Arctic waters, a region showing strong signals of climate change, that circulate in the deep basins, allowing them warm further. The Gulf of Maine is also linked to the south to the regions of the Georges Bank and Long Island Sound of Southern New England and the Mid-Atlantic Bight further south. These waters have historically been connected transiently, but have shown increasing homogenization in recent years.
  
|   As the Gulf of Maine circulating waters allow it to warm more quickly than its southern neighbors, the thermal conditions of this northern region have become more similar to past and present conditions of those areas. As such, recent decades have shown a rapid onset of species encroaching into the Gulf of Maine that had, historically, been seasonal visitors at most. New arrivals or expanding populations include those of the Atlantic blue crab (_Callinectes sapidus_), black sea bass (_Centropristis striata_), butterfish (_Peprilus triacanthus_), tautog (_Tautoga onitis_), and longfin squid (_Doryteuthis pealeii_) among many more. Similarly, species that have been historically abundant and important contributors to the Gulf of Maine ecosystem have shown appreciable declines due, at least in part, to climate change. These struggling species of the region include Atlantic cod (_Gadus morhua_), Northern shrimp (_Pandalus borealis_), Atlantic salmon (_Salmo salar_), with the collapse of American lobster (_Americanus homarus_) on the horizon in the eyes of many researchers. The reason for these changes in species' abundance within the region is due to the widespread pattern of range shifts experienced by marine organisms.

|   Species, both in marine and terrestrial ecosystems, rely on habitable conditions that are specific to their needs. Due to progressive climate change, the conditions of a local area may become inhabitable for a species or individual that previously were. This change can result in contractions of a population's range. However, as condition changes are global, it is probable that an area previously inhabitable becomes habitable for that same species allow an expansion of their range. These two components, a push and pull on a population's range, can happen simultaneously resulting in an other shift in the areas used by a species. Work has shown that the expansion or leading edge of range shifts responds more quickly to climate change than does contraction or the lagging edge [@fredston-hermann_cold_2020]. 
  
|
Fish physiological demands, double whammy.
  
|
Mismatch driven by spatial discontinuity.

|
Trophic interactions and historical changes.

|
Objectives for the dissertation.


## Methods
  NMFS Bottom Trawl Survey and Food Habits Database
  
  
``` {r data,include=F}


load("Data/googleMap.zoom6.eastCoast.R")
load("Data/prey19.RData")
allTrawls<-read_csv("Data/allTrawls.csv")
statAreas<-st_read("Data/Statistical_Areas_2010_withNames.shp",quiet=T)
statAreas<-filter(statAreas,Id%in%allTrawls$AREA)
statAreas<-st_transform(statAreas,4326)

prey19%<>%
  mutate(geoarea=factor(geoarea,levels=c("MAB","SNE","GB","GoM","ScS")))


#Using shapefiles to build a clean map
world<-map_data("world")
states<-map_data("state")


#The names of my species, just to have them nice and handy for later
myspecies_sci<-unique(str_to_upper(prey19$pdscinam))


```


``` {r editing, include=F}

#Modifying the data as needed

#Available diets
prey19<-prey19%>%
  mutate(gensci=ifelse(pynam=="PRIONOTUS ALATUS"|pynam=="STERNOPTYCHIDAE","FISH",as.character(gensci)),
         analsci=ifelse(pynam=="PRIONOTUS ALATUS","TRIGLIDAE",as.character(analsci)),
         collsci=ifelse(pynam=="PRIONOTUS ALATUS",as.character(pynam),as.character(collsci)),
         analsci=ifelse(pynam=="STERNOPTYCHIDAE","STERNOPTYCHIDAE",as.character(analsci)),
         collsci=ifelse(pynam=="STERNOPTYCHIDAE","STERNOPTYCHIDAE",as.character(collsci)),
         year=ifelse(is.na(year),substr(cruise6,1,4),year),year=as.numeric(year))%>%
  filter(pdlen<300) #There is a Summer Flounder that was listed at 300 cm, which is unbelievable, so it will be dropped


uniquePrey19<-prey19%>%
  dplyr::select(cruise6,station,svspp,pdsex,pdid,pdcomnam,pdscinam,pdlen,pdwgt,sizecat,pdgutw,pdgutv,declat,declon,month,day,year,season,geoarea)%>%
  distinct()%>%
  mutate(cruise6=as(cruise6,"character"),pdsex=as.character(pdsex),
         station=as.character(str_sub(paste0("0000",station),-4,-1)))

min<-uniquePrey19%>%
  filter(!is.na(year)&season%in%c("SPRING","FALL"))%>%
  mutate(pdcomnam=str_to_title(pdcomnam),
         year=as.factor(year),
         season=factor(str_to_sentence(season),levels=c("Spring","Fall")))%>%
  group_by(pdcomnam,year,season,.drop=F)%>%
  summarise(count=n())%>%distinct()%>%
  group_by(pdcomnam)%>%
  mutate(year=as.character(year),
         season=as.character(season))%>%
  filter(year>=min(subset(year,count>0)))%>%
  summarise(min=min(count,na.rm=T),
            minyear=subset(year,count==min(count,na.rm=T)),
            minseason=subset(season,count==min(count,na.rm=T)))%>%
  summarise(min=min,
            minyearseason=ifelse(n()>1,paste(n(),"times"),paste(minseason,minyear)))%>%distinct()



#The categories from Garrison and Link, 2000
gl_preycats<-read.csv("Data/GarrisonLink_preyCats.csv")%>%
  mutate(matchingCats=gsub("p\\.","",Scientific.name),
         matchingCats=gsub("crabs","crab",matchingCats),
         matchingCats=gsub("Gammaridae","Gammaridea",matchingCats),
         matchingCats=gsub("Cnidarians","Cnidaria",matchingCats))

prey19<-prey19%>%
  mutate(INgen=ifelse(str_to_sentence(gensci) %in% gl_preycats$matchingCats,1,0),
         INanal=ifelse(str_to_sentence(analsci) %in% gl_preycats$matchingCats,1,0),
         INcoll=ifelse(str_to_sentence(collsci) %in% gl_preycats$matchingCats,1,0),
         INpy=ifelse(str_to_sentence(pynam) %in% gl_preycats$matchingCats,1,0))
prey19<-prey19%>%
  mutate(INnum=rowSums(prey19[,c("INgen","INanal","INcoll","INpy")]),
         gl_prey=ifelse(INnum==4,str_to_sentence(pynam), #STEP 1 
                  ifelse(INnum==3&INpy==1,str_to_sentence(pynam),
                   ifelse(INnum==3&INpy==0,str_to_sentence(collsci),
                    ifelse(INnum==2&INpy==1,str_to_sentence(pynam),
                     ifelse(INnum==2&INgen==1,str_to_sentence(analsci),
                      ifelse(INnum==2&INgen==0&INpy==0,str_to_sentence(collsci),
                       ifelse(INnum==1&INgen==1,str_to_sentence(gensci),
                        ifelse(INnum==1&INanal==1,str_to_sentence(analsci),
                         ifelse(INnum==1&INcoll==1,str_to_sentence(collsci),
                          ifelse(INnum==1&INpy==1,str_to_sentence(pynam),
                           ifelse(INnum==0&pynam=="EMPTY","Empty",NA))))))))))),
         gl_prey=ifelse(pynam %in% c("UROPHYCIS CHUSS","UROPHYCIS TENUIS","UROPHYCIS REGIA"),"Other hakes", #STEP 2
                  ifelse(analsci %in% c("GADIDAE","BREGMACEROTIDAE","EUCLICHTHYIDAE","LOTIDAE","MACROURIDAE",
                                        "MELANONIDAE","MERLUCCIIDAE","MORIDAE","MURAENOLEPIDIDAE","PHYCIDAE") & 
                           is.na(gl_prey),"Gadiformes", #STEP 3a
                   ifelse(analsci %in% c("PLEURONECTIDAE","PSETTODIDAE","CITHARIDAE","SCOPHTHALMIDAE","PARALICHTHYIDAE",
                                         "BOTHIDAE","PARALICHTHODIDAE","POECILOPSETTIDAE","RHOMBOSOLEIDAE",
                                         "ACHIROPSETTIDAE","SAMARIDAE","ACHIRIDAE","SOLEIDAE","CYNOGLOSSIDAE") & 
                            is.na(gl_prey), "Pleuronectiformes", #STEP 3b
                    ifelse(gensci=="FISH" & is.na(gl_prey),"Other fish", #STEP 4
                     ifelse((gensci %in% c("UROCHORDATA","BRACHIOPODA","BRYOZOA","CHAETOGNATHA","PORIFERA") | 
                              collsci %in% c("ARTHROPODA","INSECTA","HEMICHORDATA","LIMULUS POLYPHEMUS",
                                             "APHRODITIDAE","OLIGOCHAETA","HIRUDENEA","PYCNOGONIDA")) & 
                           is.na(gl_prey),"Other invertebrates", #STEP 5
                      ifelse(analsci %in% c("CEPHALOCHORDATA"),"Other", #STEP 6
                       ifelse(collsci %in% c("OSTRACODA","CUMACEA","STOMATOPODA","PENAEIDAE"),
                              "Crustacean shrimp", #STEP 7
                        ifelse(analsci %in% c("CIRRIPEDIA","COPEPODA") | 
                                 pynam %in% c("DECAPODA","DECAPODA EGGS","DECAPODA LARVAE"),"Crustacea", #STEP 8
                         ifelse(collsci %in% c("HOMARUS AMERICANUS","CALLINECTES SAPIDUS","DECAPODA LARVAE","SCYLLARIDAE") &
                                  is.na(gl_prey), "Decapoda crab", #STEP 9
                          ifelse(analsci=="EUPHAUSIACEA","Euphausiidae",gl_prey))))))))))) #STEP 10



#How many different levels are there in all the different levels
itemDetails<-prey19%>%
  mutate(total_pynam=n_distinct(pynam),
         total_gennam=n_distinct(gensci),
         total_analnam=n_distinct(analsci),
         total_colnam=n_distinct(collsci),
         total_glnam=n_distinct(gl_prey))%>%
  group_by(gensci)%>%
  mutate(gen_pynam=n_distinct(pynam),
         gen_analnam=n_distinct(analsci),
         gen_colnam=n_distinct(collsci))%>%
  ungroup()%>%
  group_by(analsci)%>%
  mutate(anal_pynam=n_distinct(pynam),
         anal_colnam=n_distinct(collsci))%>%
  ungroup()%>%
  group_by(collsci)%>%
  mutate(coll_pynam=n_distinct(pynam))%>%
  dplyr::select(pynam,gensci,analsci,collsci,total_pynam:coll_pynam)%>%unique()
itemDetails<-itemDetails[,c("gensci","analsci","collsci","pynam","total_gennam","total_glnam","total_analnam","total_colnam",
                            "total_pynam","gen_analnam","gen_colnam","gen_pynam","anal_colnam","anal_pynam","coll_pynam")]  





#How often are each of the predators prey to each of the predators
speciesPrey<-prey19%>%
  group_by(pdscinam)%>%
  mutate(total_items=n())%>%
  filter(pynam%in%myspecies_sci)%>%
  mutate(pynam=factor(pynam,levels=myspecies_sci),
         pdscinam=factor(pdscinam,levels=myspecies_sci))%>%
  count(pynam,pdscinam,total_items,.drop=F,name="n_prey")%>%
  mutate(prop_prey=n_prey/total_items,
         preyLab=str_to_sentence(pynam),
         preyLab=factor(preyLab,levels=str_to_sentence(myspecies_sci)),
         pdscinam=gsub(" ","\n",str_to_sentence(pdscinam)))%>%
  group_by(pdscinam)%>%
  mutate(total_prop=sum(prop_prey,na.rm=T))%>%
  group_by(pynam)%>%
  mutate(total_eaten=sum(n_prey),
         prop_eaten=total_eaten/nrow(prey19),
         nchars=nchar(as.character(preyLab)))
speciesPrey[is.na(speciesPrey)]<-0


```






``` {r mapping, echo=F, message=F, warning=F,fig.width=11,fig.height=11,fig.cap="Map of the trawl positions overlain by the NMFS Statistical areas."}



ggplot()+
  geom_polygon(data=world,aes(long,lat,group=group),fill="antiquewhite")+
  geom_polygon(data=states,aes(long,lat,group=group),fill="transparent",color="grey50")+
  geom_spatial_point(data=prey19,aes(-1*declon,declat,color=geoarea),crs=4326)+
  geom_sf(data=statAreas,fill="transparent",col="black")+
  scale_color_manual(values=colorspace::rainbow_hcl(5,c=100,end=290),name="Geographic\nRegion")+
  guides(color=guide_legend(override.aes = list(size=9)))+
  annotation_scale(location="br",width_hint=0.4,height=unit(0.125,"in"),
                   pad_x=unit(0.25,"in"),pad_y=unit(0.4,"in"),text_cex=1.2)+
  geom_rect(aes(xmin=-63.35,xmax=-62.5,ymin=35.8,ymax=36.2),fill="azure1")+
  annotation_north_arrow(location="br",pad_x=unit(0.5,"in"),pad_y=unit(0.75,"in"),
                         style = north_arrow_fancy_orienteering(text_size=15,line_width=1.25),
                         height=unit(1,"in"),width=unit(0.9,"in"))+
  coord_sf(xlim=c(-77.8,st_bbox(statAreas)$xmax),
           ylim=c(35.2,st_bbox(statAreas)$ymax))+
  theme(legend.position=c(0.225,0.8),legend.background=element_rect(color="black"),
        panel.grid.major = element_line(color=rgb(0.5,0.5,0.5,alpha=0.7),linetype="dashed",size=0.5),
        panel.background = element_rect(fill="azure1"))+
  xlab("Longitude")+ylab("Latitude")


```




``` {r data summary, echo=F, message=F,warning=F,fig.width=20,fig.height=15,fig.cap="Number of diets collected for each of 9 target predator species by the National Marine Fisheries Service during the annual Spring-Fall Bottom Trawl Survey since 1973. Differences represent predator availability as well as research prioritization, both of which have varied over time. The minimum number of diets collected by a season of trawls is noted in each panel, along with the season in which it occurred. If the minimum number of diets for a species occurred in multiple seasons, the number of seasons is listed instead.\\label{fig:dietNum}"}

uniquePrey19%>%
  filter(!is.na(year)&season%in%c("SPRING","FALL"))%>%
  mutate(pdcomnam=str_to_title(pdcomnam),
         year=as.factor(year),
         season=factor(str_to_sentence(season),levels=c("Spring","Fall")))%>%
  group_by(pdcomnam,year,season,.drop=F)%>%
  summarise(count=n())%>%distinct()%>%
  filter(count>0)%>%ungroup()%>%
  mutate(yearseason=ifelse(season=="Spring",as.numeric(as.character(year))-0.25,as.numeric(as.character(year))+0.25),
         g = c(0, cumsum(diff(yearseason) > 0.5))) %>%
 ggplot()+
  geom_line(aes(yearseason,count,color=pdcomnam,group=g),size=1.5)+
  geom_point(aes(yearseason,count,fill=season,color=pdcomnam,group=g),size=3,shape=21,stroke=2)+
  geom_text(data=min,aes(2010,2010,label=paste0("Min=",min,": ",minyearseason)),size=7)+
  scale_color_manual(values=colorspace::rainbow_hcl(9,c=100,l=60),guide="none")+
  scale_fill_manual(values=seasonPal2[c(2,4)],name="Season")+
  scale_y_continuous(expand=expansion(mult=c(0.035,0.1)),name="Number of Diets Collected")+
  scale_x_continuous(name="Year")+
  guides(fill=guide_legend(override.aes=list(stroke=0.5,size=6)))+
  facet_wrap(~pdcomnam)


```


``` {r prey summary, echo=F, message=F, warning=F,fig.height=6,fig.width=10,fig.cap="Number of unique prey names at each level of resolution. General, Analytical, and Collection scales refer to groupings provided by the National Marine Fisheries Service; Prey name is the most specific a visual observer could identify an item to; and cf. Garrison and Link, 2000 refers to that grouping used in their feeding guild analyses.\\label{fig:preynames}"}


#How many are in each of the prey levels
itemDetails%>%
  ungroup()%>%
  pivot_longer(cols=starts_with("total"))%>%
  dplyr::select(name,value)%>%distinct()%>%
  mutate(name=factor(name))%>%
  ggplot()+
  geom_col(aes(fct_reorder(name,value),value,fill=fct_reorder(name,value)),color="black")+
  scale_fill_brewer(palette="PuRd",guide="none")+
  scale_y_continuous(name="Number of unique items")+
  scale_x_discrete(name="Prey Resolution",
                     labels=c("General","cf. Garrison\nand Link, 2000","Analytical","Collection","Species"))
  
  
```



``` {r emptiness, echo=F,message=F,warning=F,fig.width=24,fig.height=24,fig.cap="Percentage of stomachs that are empty over time for each of the predator species in each of the geographic regions. The rightmost columns represents the cumulative across regions for each species. The bottom row represents the cumulative across species for each region. Horizontal red lines in each show the mean across all years for that subset. Regions are ordered by increasing latitude from left to right, species are ordered by increasing percentage of empty stomachs from top to bottom.\\label{fig:empty}"}

#Over the years for each species
s<-prey19%>%
  mutate(ID=paste(svspp,cruise6,station,pdsex,pdid,pdlen,pdwgt,sep="-"))%>%
  group_by(pdcomnam)%>%
  mutate(total=n_distinct(ID))%>%
  group_by(gensci,pdcomnam,total)%>%
  mutate(total_empty=n_distinct(ID),
         total_p_empty=(total_empty/total)*100)%>%ungroup()%>%
  group_by(pdcomnam,year)%>%
  mutate(IDs=n_distinct(ID))%>%
  group_by(gensci,pdcomnam,year,IDs,total,total_empty,total_p_empty)%>%
  summarise(N_empty=n_distinct(ID),
            p_empty=(N_empty/IDs)*100)%>%filter(gensci=="EMPTY")%>%unique()%>%ungroup()%>%
  mutate(f.pdcomnam=fct_reorder(as.factor(str_to_title(pdcomnam)),p_empty))%>%
  ggplot(aes(year,p_empty,color=pdcomnam,fill=pdcomnam))+
  geom_abline(aes(slope=0,intercept=total_p_empty),color="firebrick2",size=1.5)+
  geom_line(size=2)+
  geom_point(size=3,shape=21,stroke=1.5,color="black")+
  scale_x_continuous(name="Year")+
  scale_y_continuous(name="Percent Empty Stomachs (%)",limits=c(0,100))+
  #scale_size_continuous(name="Number of\nDiets",range=c(1.5,7))+
  scale_fill_manual(values=colorspace::rainbow_hcl(9,c=100,l=60))+
  scale_color_manual(values=colorspace::rainbow_hcl(9,c=100,l=60))+
  theme(legend.position = "none")+
  facet_wrap(~f.pdcomnam,nrow=9)
 

#Over the years for each area
g<-prey19%>%
  mutate(ID=paste(svspp,cruise6,station,pdsex,pdid,pdlen,pdwgt,sep="-"))%>%
  group_by(geoarea)%>%
  mutate(total=n_distinct(ID))%>%
  group_by(gensci,geoarea,total)%>%
  mutate(total_empty=n_distinct(ID),
         total_p_empty=(total_empty/total)*100)%>%ungroup()%>%
  group_by(geoarea,year)%>%
  mutate(IDs=n_distinct(ID))%>%
  group_by(gensci,geoarea,year,IDs,total,total_empty,total_p_empty)%>%
  summarise(N_empty=n_distinct(ID),
            p_empty=(N_empty/IDs)*100)%>%filter(gensci=="EMPTY")%>%unique()%>%ungroup()%>%
  mutate(geoarea=factor(geoarea,levels=c("MAB","SNE","GB","GoM","ScS")))%>%
  ggplot(aes(year,p_empty,shape=geoarea))+
  geom_abline(aes(slope=0,intercept=total_p_empty),color="firebrick2",size=1.5)+
  geom_line(color="black",size=2)+
  geom_point(fill="black",size=3,stroke=1.5)+
  scale_x_continuous(name="Year")+
  scale_y_continuous(name="Percent Empty Stomachs (%)",limits=c(0,100))+
  #scale_size_continuous(name="Number of\nDiets",range=c(1.5,7))+
  scale_shape_manual(values=c(21:25),guide="none")+
  facet_wrap(~geoarea,nrow=1)


#Over the years for each species in each area
a<-prey19%>%
  mutate(ID=paste(svspp,cruise6,station,pdsex,pdid,pdlen,pdwgt,sep="-"))%>%
  group_by(pdcomnam,geoarea)%>%
  mutate(total=n_distinct(ID))%>%
  group_by(gensci,pdcomnam,geoarea,total)%>%
  mutate(total_empty=n_distinct(ID),
         total_p_empty=(total_empty/total)*100)%>%ungroup()%>%
  group_by(pdcomnam,geoarea,year)%>%
  mutate(IDs=n_distinct(ID))%>%
  group_by(gensci,pdcomnam,geoarea,year,IDs,total,total_empty,total_p_empty)%>%
  summarise(N_empty=n_distinct(ID),
            p_empty=(N_empty/IDs)*100)%>%filter(gensci=="EMPTY")%>%unique()%>%ungroup()%>%
  mutate(f.pdcomnam=fct_reorder(as.factor(str_to_title(pdcomnam)),p_empty),
         geoarea=factor(geoarea,levels=c("MAB","SNE","GB","GoM","ScS")))%>%
  ggplot(aes(year,p_empty,color=pdcomnam,fill=pdcomnam,shape=geoarea))+
  geom_abline(aes(slope=0,intercept=total_p_empty),color="firebrick2",size=1.5)+
  geom_line(size=2,show.legend = F)+
  geom_point(size=3,stroke=1.25,color="black")+
  scale_x_continuous(name="Year")+
  scale_y_continuous(name="Percent Empty Stomachs (%)",limits=c(0,100))+
  #scale_size_continuous(name="Number of\nDiets",range=c(1.5,7))+
  scale_fill_manual(values=colorspace::rainbow_hcl(9,c=100,l=50))+
  scale_color_manual(values=colorspace::rainbow_hcl(9,c=100,l=50))+
  scale_shape_manual(values=c(21:25))+
  guides(fill="none",shape="none")+
  theme(plot.margin=unit(c(12.5,15,15,12.5),"pt"))+
  facet_wrap(~f.pdcomnam+geoarea,nrow=9,labeller = label_wrap_gen(multi_line=FALSE))


#Put them all together
grid.arrange(a,s,g,nrow=2,layout_matrix=rbind(c(1,1,1,2),
                                              c(1,1,1,2),
                                              c(1,1,1,2),
                                              c(1,1,1,2),
                                              c(3,3,3,NA)))






```


The predators show signs of predation upon each other, however this is largely focused on Silver Hake, even when that requires cannibalism (Figure \ref{fig:selfprey}).


``` {r investigating, echo=F,message=F,warning=F,fig.width=12,fig.height=8,fig.cap="Proportion of consumption for each predator species of the other predator species, including cannibalism. Red lines represent the total proportion on self and other target predator species. Prey names include the number of instances of predation upon that species. Note square-root scale for proportions.\\label{fig:selfprey}"}

ggplot(speciesPrey,aes(fct_reorder(pdscinam,total_prop),prop_prey,fill=preyLab))+
  geom_col(position = "dodge",color="black",size=0.5)+
  geom_errorbar(aes(ymin=total_prop,ymax=total_prop), color = "firebrick3") +
  #geom_segment(aes(x=pdscinam-1,xend=pdscinam,y=total_prop,yend=total_prop),size=5,shape=22,fill="firebrick2")+
  scale_x_discrete(name="Predator Species")+
  scale_y_sqrt(name="Proportion of Predator Diet",expand=expansion(add=c(0.001,0.01)))+
  scale_fill_viridis_d(name="Prey Species", 
                       labels=paste0(speciesPrey$preyLab,strrep(" ",24-speciesPrey$nchars),"(n=",speciesPrey$total_eaten,")"))+
  theme(legend.position=c(0.7,0.25),legend.background=element_rect(color="black"),
        legend.text=element_text(family="mono",size=15))+
  coord_flip()


```











# References



